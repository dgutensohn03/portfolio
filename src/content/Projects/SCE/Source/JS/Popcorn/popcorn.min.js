(function(n,t){function r(n){it.put.call(this,n)}function o(n){this.parent=n;this.byStart=[{start:-1,end:-1}];this.byEnd=[{start:-1,end:-1}];this.animating=[];this.startIndex=0;this.endIndex=0;this.previousUpdateTime=-1;this.count=1}function w(n,t,i){return n[t]&&n[t]===i}function rt(n,t){var r={};for(var i in n)u.call(t,i)&&u.call(n,i)&&(r[i]=n[i]);return r}function ut(n,t){return function(){if(i.plugin.debug)return n.apply(this,arguments);try{return n.apply(this,arguments)}catch(r){i.plugin.errors.push({plugin:t,thrown:r,source:n.toString()});this.emit("pluginerror",i.plugin.errors)}}}var s,b,k,d;if(!t.addEventListener){for(n.Popcorn={isSupported:!1},s="byId forEach extend effects error guid sizeOf isArray nop position disable enable destroyaddTrackEvent removeTrackEvent getTrackEvents getTrackEvent getLastTrackEventId timeUpdate plugin removePlugin compose effect xhr getJSONP getScript".split(/\s+/);s.length;)n.Popcorn[s.shift()]=function(){};return}var h=Array.prototype,c=Object.prototype,l=h.forEach,a=h.slice,u=c.hasOwnProperty,v=c.toString,g=n.Popcorn,e=[],y=!1,nt=!1,f={events:{hash:{},apis:{}}},p=function(){return n.requestAnimationFrame||n.webkitRequestAnimationFrame||n.mozRequestAnimationFrame||n.oRequestAnimationFrame||n.msRequestAnimationFrame||function(t){n.setTimeout(t,16)}}(),tt=function(n){return Object.keys?Object.keys(n):function(n){var t,i=[];for(t in n)u.call(n,t)&&i.push(t);return i}(n)},it={put:function(n){for(var t in n)n.hasOwnProperty(t)&&(this[t]=n[t])}},i=function(n,t){return new i.p.init(n,t||null)};i.version="@VERSION";i.isSupported=!0;i.instances=[];i.p=i.prototype={init:function(n,r){var c,s,u=this,h,f;if(typeof n=="function"){if(t.readyState==="complete"){n(t,i);return}e.push(n);y||(y=!0,h=function(){nt=!0;t.removeEventListener("DOMContentLoaded",h,!1);for(var n=0,r=e.length;n<r;n++)e[n].call(t,i);e=null},t.addEventListener("DOMContentLoaded",h,!1));return}if(typeof n=="string")try{c=t.querySelector(n)}catch(l){throw new Error("Popcorn.js Error: Invalid media element selector: "+n);}if(this.media=c||n,s=this.media.nodeName&&this.media.nodeName.toLowerCase()||"video",this[s]=this.media,this.options=i.extend({},r)||{},this.id=this.options.id||i.guid(s),i.byId(this.id))throw new Error("Popcorn.js Error: Cannot use duplicate ID ("+this.id+")");return this.isDestroyed=!1,this.data={running:{cue:[]},timeUpdate:i.nop,disabled:{},events:{},hooks:{},history:[],state:{volume:this.media.volume},trackRefs:{},trackEvents:new o(this)},i.instances.push(this),f=function(){u.media.currentTime<0&&(u.media.currentTime=0);u.media.removeEventListener("loadedmetadata",f,!1);var n,e,t,o,s,r;n=u.media.duration;e=n!=n?Number.MAX_VALUE:n+1;i.addTrackEvent(u,{start:e,end:e});u.isDestroyed||(u.data.durationChange=function(){var e=u.media.duration,i=e+1,r=u.data.trackEvents.byStart,f=u.data.trackEvents.byEnd,n,t;for(r.pop(),f.pop(),n=f.length-1;n>0;n--)f[n].end>e&&u.removeTrackEvent(f[n]._id);for(t=0;t<r.length;t++)r[t].end>e&&u.removeTrackEvent(r[t]._id);u.data.trackEvents.byEnd.push({start:i,end:i});u.data.trackEvents.byStart.push({start:i,end:i})},u.media.addEventListener("durationchange",u.data.durationChange,!1));u.options.frameAnimation?(u.data.timeUpdate=function(){i.timeUpdate(u,{});i.forEach(i.manifest,function(n,i){if(t=u.data.running[i],t){s=t.length;for(var f=0;f<s;f++)o=t[f],r=o._natives,r&&r.frame&&r.frame.call(u,{},o,u.currentTime())}});u.emit("timeupdate");u.isDestroyed||p(u.data.timeUpdate)},u.isDestroyed||p(u.data.timeUpdate)):(u.data.timeUpdate=function(n){i.timeUpdate(u,n)},u.isDestroyed||u.media.addEventListener("timeupdate",u.data.timeUpdate,!1))},u.media.addEventListener("error",function(){u.error=u.media.error},!1),u.media.readyState>=1?f():u.media.addEventListener("loadedmetadata",f,!1),this}};i.p.init.prototype=i.p;i.byId=function(n){for(var r=i.instances,u=r.length,t=0;t<u;t++)if(r[t].id===n)return r[t];return null};i.forEach=function(n,t,i){if(!n||!t)return{};i=i||this;var r,f;if(l&&n.forEach===l)return n.forEach(t,i);if(v.call(n)==="[object NodeList]"){for(r=0,f=n.length;r<f;r++)t.call(i,n[r],r,n);return n}for(r in n)u.call(n,r)&&t.call(i,n[r],r,n);return n};i.extend=function(n){var t=n,r=a.call(arguments,1);return i.forEach(r,function(n){for(var i in n)t[i]=n[i]}),t};i.extend(i,{noConflict:function(t){return t&&(n.Popcorn=g),i},error:function(n){throw new Error(n);},guid:function(n){return i.guid.counter++,(n?n:"")+(+new Date+i.guid.counter)},sizeOf:function(n){var t=0;for(var i in n)t++;return t},isArray:Array.isArray||function(n){return v.call(n)==="[object Array]"},nop:function(){},position:function(r){var o;if(!r.parentNode)return null;var u=r.getBoundingClientRect(),s={},p=r.ownerDocument,f=t.documentElement,e=t.body,h,c,l,a,v,y;h=f.clientTop||e.clientTop||0;c=f.clientLeft||e.clientLeft||0;l=n.pageYOffset&&f.scrollTop||e.scrollTop;a=n.pageXOffset&&f.scrollLeft||e.scrollLeft;v=Math.ceil(u.top+l-h);y=Math.ceil(u.left+a-c);for(o in u)s[o]=Math.round(u[o]);return i.extend({},s,{top:v,left:y})},disable:function(n,t){if(!n.data.disabled[t]){if(n.data.disabled[t]=!0,t in i.registryByName&&n.data.running[t])for(var u=n.data.running[t].length-1,r;u>=0;u--)r=n.data.running[t][u],r._natives.end.call(n,null,r),n.emit("trackend",i.extend({},r,{plugin:r.type,type:"trackend"}));return n}},enable:function(n,t){if(n.data.disabled[t]){if(n.data.disabled[t]=!1,t in i.registryByName&&n.data.running[t])for(var u=n.data.running[t].length-1,r;u>=0;u--)r=n.data.running[t][u],r._natives.start.call(n,null,r),n.emit("trackstart",i.extend({},r,{plugin:r.type,type:"trackstart",track:r}));return n}},destroy:function(n){var t=n.data.events,f=n.data.trackEvents,r,u,e,o;for(u in t){r=t[u];for(e in r)delete r[e];t[u]=null}for(o in i.registryByName)i.removePlugin(n,o);f.byStart.length=0;f.byEnd.length=0;n.isDestroyed||(n.data.timeUpdate&&n.media.removeEventListener("timeupdate",n.data.timeUpdate,!1),n.isDestroyed=!0);i.instances.splice(i.instances.indexOf(n),1)}});i.guid.counter=1;i.extend(i.p,function(){var n={};return i.forEach("load play pause currentTime playbackRate volume duration preload playbackRate autoplay loop controls muted buffered readyState seeking paused played seekable ended".split(/\s+/g),function(t){n[t]=function(n){var r;return typeof this.media[t]=="function"?(n!=null&&/play|pause/.test(t)&&(this.media.currentTime=i.util.toSeconds(n)),this.media[t](),this):n!=null?(r=this.media[t],this.media[t]=n,r!==n&&this.emit("attrchange",{attribute:t,previousValue:r,currentValue:n}),this):this.media[t]}}),n}());i.forEach("enable disable".split(" "),function(n){i.p[n]=function(t){return i[n](this,t)}});i.extend(i.p,{roundTime:function(){return Math.round(this.media.currentTime)},exec:function(n,t,u){var s=arguments.length,h="trackadded",e,o,f;try{o=i.util.toSeconds(n)}catch(c){}if(typeof o=="number"&&(n=o),typeof n=="number"&&s===2)u=t,t=n,n=i.guid("cue");else if(s===1)t=-1;else if(e=this.getTrackEvent(n),e)this.data.trackEvents.remove(n),r.end(this,e),i.removeTrackEvent.ref(this,n),h="cuechange",typeof n=="string"&&s===2&&(typeof t=="number"&&(u=e._natives.start),typeof t=="function"&&(u=t,t=e.start));else if(s>=2){if(typeof t=="string"){try{o=i.util.toSeconds(t)}catch(c){}t=o}typeof t=="number"&&(u=u||i.nop());typeof t=="function"&&(u=t,t=-1)}return f={id:n,start:t,end:t+1,_running:!1,_natives:{start:u||i.nop,end:i.nop,type:"cue"}},e&&(f=i.extend(e,f)),h==="cuechange"?(f._id=f.id||f._id||i.guid(f._natives.type),this.data.trackEvents.add(f),r.start(this,f),this.timeUpdate(this,null,!0),i.addTrackEvent.ref(this,f),this.emit(h,i.extend({},f,{id:n,type:h,previousValue:{time:e.start,fn:e._natives.start},currentValue:{time:t,fn:u||i.nop},track:e}))):i.addTrackEvent(this,f),this},mute:function(n){var t=n==null||n===!0?"muted":"unmuted";return t==="unmuted"&&(this.media.muted=!1,this.media.volume=this.data.state.volume),t==="muted"&&(this.data.state.volume=this.media.volume,this.media.muted=!0),this.emit(t),this},unmute:function(n){return this.mute(n==null?!1:!n)},position:function(){return i.position(this.media)},toggle:function(n){return i[this.data.disabled[n]?"enable":"disable"](this,n)},defaults:function(n,t){return i.isArray(n)?(i.forEach(n,function(n){for(var t in n)this.defaults(t,n[t])},this),this):(this.options.defaults||(this.options.defaults={}),this.options.defaults[n]||(this.options.defaults[n]={}),i.extend(this.options.defaults[n],t),this)}});i.Events={UIEvents:"blur focus focusin focusout load resize scroll unload",MouseEvents:"mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave click dblclick",Events:"loadstart progress suspend emptied stalled play pause error loadedmetadata loadeddata waiting playing canplay canplaythrough seeking seeked timeupdate ended ratechange durationchange volumechange"};i.Events.Natives=i.Events.UIEvents+" "+i.Events.MouseEvents+" "+i.Events.Events;f.events.apiTypes=["UIEvents","MouseEvents","Events"],function(n,t){for(var u=f.events.apiTypes,r=n.Natives.split(/\s+/g),i=0,e=r.length;i<e;i++)t.hash[r[i]]=!0;u.forEach(function(i){t.apis[i]={};for(var u=n[i].split(/\s+/g),f=u.length,r=0;r<f;r++)t.apis[i][u[r]]=!0})}(i.Events,f.events);i.events={isNative:function(n){return!!f.events.hash[n]},getInterface:function(n){if(!i.events.isNative(n))return!1;for(var u=f.events,e=u.apiTypes,s=u.apis,t=0,h=e.length,o,r;t<h;t++)if(r=e[t],s[r][n]){o=r;break}return o},all:i.Events.Natives.split(/\s+/g),fn:{trigger:function(r,u){var f,e,o,s=this.data.events[r];if(s){if(f=i.events.getInterface(r),f)return e=t.createEvent(f),e.initEvent(r,!0,!0,n,1),this.media.dispatchEvent(e),this;for(o=s.slice();o.length;)o.shift().call(this,u)}return this},listen:function(n,t){var u=this,f=!0,r=i.events.hooks[n],s=n,e,o;if(typeof t!="function")throw new Error("Popcorn.js Error: Listener is not a function");return this.data.events[n]||(this.data.events[n]=[],f=!1),r&&(r.add&&r.add.call(this,{},t),r.bind&&(n=r.bind),r.handler&&(o=t,t=function(n){r.handler.call(u,n,o)}),f=!0,this.data.events[n]||(this.data.events[n]=[],f=!1)),this.data.events[n].push(t),!f&&i.events.all.indexOf(n)>-1&&this.media.addEventListener(n,function(t){if(u.data.events[n])for(e=u.data.events[n].slice();e.length;)e.shift().call(u,t)},!1),this},unlisten:function(n,t){var u,i=this.data.events[n],r;if(i){if(typeof t=="string"){for(r=0;r<i.length;r++)i[r].name===t&&i.splice(r--,1);return this}if(typeof t=="function"){while(u!==-1)u=i.indexOf(t),u!==-1&&i.splice(u,1);return this}return this.data.events[n]=null,this}}},hooks:{canplayall:{bind:"canplaythrough",add:function(n,t){var i=!1;this.media.readyState&&(setTimeout(function(){t.call(this,n)}.bind(this),0),i=!0);this.data.hooks.canplayall={fired:i}},handler:function(n,t){this.data.hooks.canplayall.fired||(t.call(this,n),this.data.hooks.canplayall.fired=!0)}}}};i.forEach([["trigger","emit"],["listen","on"],["unlisten","off"]],function(n){i.p[n[0]]=i.p[n[1]]=i.events.fn[n[0]]});r.start=function(n,t){t.end>n.media.currentTime&&t.start<=n.media.currentTime&&!t._running&&(t._running=!0,n.data.running[t._natives.type].push(t),n.data.disabled[t._natives.type]||(t._natives.start.call(n,null,t),n.emit("trackstart",i.extend({},t,{plugin:t._natives.type,type:"trackstart",track:t}))))};r.end=function(n,t){var r;(t.end<=n.media.currentTime||t.start>n.media.currentTime)&&t._running&&(r=n.data.running[t._natives.type],t._running=!1,r.splice(r.indexOf(t),1),n.data.disabled[t._natives.type]||(t._natives.end.call(n,null,t),n.emit("trackend",i.extend({},t,{plugin:t._natives.type,type:"trackend",track:t}))))};o.prototype.where=function(n){return(this.parent.getTrackEvents()||[]).filter(function(t){var i,r;if(!n)return!0;for(i in n)if(r=n[i],w(t,i,r)||w(t._natives,i,r))return!0;return!1})};o.prototype.add=function(n){var u=this.byStart,f=this.byEnd,t,r;for(n&&n._id&&this.parent.data.history.push(n._id),n.start=i.util.toSeconds(n.start,this.parent.options.framerate),n.end=i.util.toSeconds(n.end,this.parent.options.framerate),t=u.length-1;t>=0;t--)if(n.start>=u[t].start){u.splice(t+1,0,n);break}for(r=f.length-1;r>=0;r--)if(n.end>f[r].end){f.splice(r+1,0,n);break}t<=this.parent.data.trackEvents.startIndex&&n.start<=this.parent.data.trackEvents.previousUpdateTime&&this.parent.data.trackEvents.startIndex++;r<=this.parent.data.trackEvents.endIndex&&n.end<this.parent.data.trackEvents.previousUpdateTime&&this.parent.data.trackEvents.endIndex++;this.count++};o.prototype.remove=function(n,t){var e;if(n instanceof r&&(n=n.id),typeof n=="object")return this.where(n).forEach(function(n){this.removeTrackEvent(n._id)},this.parent),this;var i,o,f,v,p,s=this.byStart.length,u=0,h=0,c=[],l=[],a=[],y=[];for(t=t||{};--s>-1;)i=this.byStart[u],o=this.byEnd[u],i._id||(c.push(i),l.push(o)),i._id&&(i._id!==n&&c.push(i),o._id!==n&&l.push(o),i._id===n&&(h=u,p=i)),u++;if(s=this.animating.length,u=0,s)while(--s>-1)f=this.animating[u],f._id||a.push(f),f._id&&f._id!==n&&a.push(f),u++;for(h<=this.startIndex&&this.startIndex--,h<=this.endIndex&&this.endIndex--,this.byStart=c,this.byEnd=l,this.animating=a,this.count--,v=this.parent.data.history.length,e=0;e<v;e++)this.parent.data.history[e]!==n&&y.push(this.parent.data.history[e]);this.parent.data.history=y};i.addTrackEvent=function(n,t){var u;t instanceof r||(t=new r(t),t&&t._natives&&t._natives.type&&n.options.defaults&&n.options.defaults[t._natives.type]&&(u=i.extend({},t),i.extend(t,n.options.defaults[t._natives.type],u)),t._natives&&(t._id=t.id||t._id||i.guid(t._natives.type),t._natives._setup&&(t._natives._setup.call(n,t),n.emit("tracksetup",i.extend({},t,{plugin:t._natives.type,type:"tracksetup",track:t})))),n.data.trackEvents.add(t),r.start(n,t),this.timeUpdate(n,null,!0),t._id&&i.addTrackEvent.ref(n,t),n.emit("trackadded",i.extend({},t,t._natives?{plugin:t._natives.type}:{},{type:"trackadded",track:t})))};i.addTrackEvent.ref=function(n,t){return n.data.trackRefs[t._id]=t,n};i.removeTrackEvent=function(n,t){var r=n.getTrackEvent(t);r&&(r._natives._teardown&&r._natives._teardown.call(n,r),n.data.trackEvents.remove(t),i.removeTrackEvent.ref(n,t),r._natives&&n.emit("trackremoved",i.extend({},r,{plugin:r._natives.type,type:"trackremoved",track:r})))};i.removeTrackEvent.ref=function(n,t){return delete n.data.trackRefs[t],n};i.getTrackEvents=function(n){for(var r=[],u=n.data.trackEvents.byStart,f=u.length,t=0,i;t<f;t++)i=u[t],i._id&&r.push(i);return r};i.getTrackEvents.ref=function(n){return n.data.trackRefs};i.getTrackEvent=function(n,t){return n.data.trackRefs[t]};i.getTrackEvent.ref=function(n,t){return n.data.trackRefs[t]};i.getLastTrackEventId=function(n){return n.data.history[n.data.history.length-1]};i.timeUpdate=function(n,t){var s=n.media.currentTime,p=n.data.trackEvents.previousUpdateTime,u=n.data.trackEvents,h=u.endIndex,c=u.startIndex,w=u.byStart.length,b=u.byEnd.length,a=i.registryByName,v="trackstart",y="trackend",e,o,f,r,l;if(p<=s){while(u.byEnd[h]&&u.byEnd[h].end<=s){if(e=u.byEnd[h],f=e._natives,r=f&&f.type,f&&!a[r]&&!n[r]){i.removeTrackEvent(n,e._id);return}e._running===!0&&(e._running=!1,l=n.data.running[r],l.splice(l.indexOf(e),1),n.data.disabled[r]||(f.end.call(n,t,e),n.emit(y,i.extend({},e,{plugin:r,type:y,track:e}))));h++}while(u.byStart[c]&&u.byStart[c].start<=s){if(o=u.byStart[c],f=o._natives,r=f&&f.type,f&&!a[r]&&!n[r]){i.removeTrackEvent(n,o._id);return}o.end>s&&o._running===!1&&(o._running=!0,n.data.running[r].push(o),n.data.disabled[r]||(f.start.call(n,t,o),n.emit(v,i.extend({},o,{plugin:r,type:v,track:o}))));c++}}else if(p>s){while(u.byStart[c]&&u.byStart[c].start>s){if(o=u.byStart[c],f=o._natives,r=f&&f.type,f&&!a[r]&&!n[r]){i.removeTrackEvent(n,o._id);return}o._running===!0&&(o._running=!1,l=n.data.running[r],l.splice(l.indexOf(o),1),n.data.disabled[r]||(f.end.call(n,t,o),n.emit(y,i.extend({},o,{plugin:r,type:y,track:o}))));c--}while(u.byEnd[h]&&u.byEnd[h].end>s){if(e=u.byEnd[h],f=e._natives,r=f&&f.type,f&&!a[r]&&!n[r]){i.removeTrackEvent(n,e._id);return}e.start<=s&&e._running===!1&&(e._running=!0,n.data.running[r].push(e),n.data.disabled[r]||(f.start.call(n,t,e),n.emit(v,i.extend({},e,{plugin:r,type:v,track:e}))));h--}}u.endIndex=h;u.startIndex=c;u.previousUpdateTime=s;u.byStart.length<w&&u.startIndex--;u.byEnd.length<b&&u.endIndex--};i.extend(i.p,{getTrackEvents:function(){return i.getTrackEvents.call(null,this)},getTrackEvent:function(n){return i.getTrackEvent.call(null,this,n)},getLastTrackEventId:function(){return i.getLastTrackEventId.call(null,this)},removeTrackEvent:function(n){return i.removeTrackEvent.call(null,this,n),this},removePlugin:function(n){return i.removePlugin.call(null,this,n),this},timeUpdate:function(n){return i.timeUpdate.call(null,this,n),this},destroy:function(){return i.destroy.call(null,this),this}});i.manifest={};i.registry=[];i.registryByName={};i.plugin=function(n,t,f){var h,c;if(i.protect.natives.indexOf(n.toLowerCase())>=0){i.error("'"+n+"' is a protected function name");return}var s=typeof t=="function",v=["start","end","type","manifest"],l=["_setup","_teardown","start","end","frame"],e={},o=function(n,t){return n=n||i.nop,t=t||i.nop,function(){n.apply(this,arguments);t.apply(this,arguments)}};return i.manifest[n]=f=f||t.manifest||{},l.forEach(function(r){t[r]=ut(t[r]||i.nop,n)}),h=function(t,e){if(!e)return this;if(e.ranges&&i.isArray(e.ranges))return i.forEach(e.ranges,function(t){var r=i.extend({},e,t);delete r.ranges;this[n](r)},this),this;var s=e._natives={},c="",h;return i.extend(s,t),e._natives.type=e._natives.plugin=n,e._running=!1,s.start=s.start||s["in"],s.end=s.end||s.out,e.once&&(s.end=o(s.end,function(){this.removeTrackEvent(e._id)})),s._teardown=o(function(){var n=a.call(arguments),t=this.data.running[s.type];n.unshift(null);n[1]._running&&t.splice(t.indexOf(e),1)&&s.end.apply(this,n);n[1]._running=!1;this.emit("trackend",i.extend({},e,{plugin:s.type,type:"trackend",track:i.getTrackEvent(this,e.id||e._id)}))},s._teardown),s._teardown=o(s._teardown,function(){this.emit("trackteardown",i.extend({},e,{plugin:n,type:"trackteardown",track:i.getTrackEvent(this,e.id||e._id)}))}),e.compose=e.compose||[],typeof e.compose=="string"&&(e.compose=e.compose.split(" ")),e.effect=e.effect||[],typeof e.effect=="string"&&(e.effect=e.effect.split(" ")),e.compose=e.compose.concat(e.effect),e.compose.forEach(function(n){c=i.compositions[n]||{};l.forEach(function(n){s[n]=o(s[n],c[n])})}),e._natives.manifest=f,"start"in e||(e.start=e["in"]||0),e.end||e.end===0||(e.end=e.out||Number.MAX_VALUE),u.call(e,"toString")||(e.toString=function(){var t=["start: "+e.start,"end: "+e.end,"id: "+(e.id||e._id)];return e.target!=null&&t.push("target: "+e.target),n+" ( "+t.join(", ")+" )"}),e.target||(h="options"in f&&f.options,e.target=h&&"target"in h&&h.target),!e._id&&e._natives&&(e._id=i.guid(e._natives.type)),e instanceof r?(e._natives&&(e._id=e.id||e._id||i.guid(e._natives.type),e._natives._setup&&(e._natives._setup.call(this,e),this.emit("tracksetup",i.extend({},e,{plugin:e._natives.type,type:"tracksetup",track:e})))),this.data.trackEvents.add(e),r.start(this,e),this.timeUpdate(this,null,!0),e._id&&i.addTrackEvent.ref(this,e)):i.addTrackEvent(this,e),i.forEach(t,function(n,t){if(v.indexOf(t)===-1)this.on(t,n)},this),this},i.p[n]=e[n]=function(f,e){var y=arguments.length,o,v,c,l,a;if(f&&!e)e=f,f=null;else{if(o=this.getTrackEvent(f),o){if(a=e,l=rt(o,a),o._natives._update)this.data.trackEvents.remove(o),u.call(e,"start")&&(o.start=e.start),u.call(e,"end")&&(o.end=e.end),r.end(this,o),s&&t.call(this,o),o._natives._update.call(this,o,e),this.data.trackEvents.add(o),r.start(this,o);else return i.extend(o,e),this.data.trackEvents.remove(f),o._natives._teardown&&o._natives._teardown.call(this,o),i.removeTrackEvent.ref(this,f),s?h.call(this,t.call(this,o),o):(o._id=o.id||o._id||i.guid(o._natives.type),o._natives&&o._natives._setup&&(o._natives._setup.call(this,o),this.emit("tracksetup",i.extend({},o,{plugin:o._natives.type,type:"tracksetup",track:o}))),this.data.trackEvents.add(o),r.start(this,o),this.timeUpdate(this,null,!0),i.addTrackEvent.ref(this,o)),this.emit("trackchange",{id:o.id,type:"trackchange",previousValue:l,currentValue:o,track:o}),this;return o._natives.type!=="cue"&&this.emit("trackchange",{id:o.id,type:"trackchange",previousValue:l,currentValue:a,track:o}),this}e.id=f}return this.data.running[n]=this.data.running[n]||[],v=this.options.defaults&&this.options.defaults[n]||{},c=i.extend({},v,e),h.call(this,s?t.call(this,c):t,c),this},f&&i.extend(t,{manifest:f}),c={fn:e[n],definition:t,base:t,parents:[],name:n},i.registry.push(i.extend(e,c,{type:n})),i.registryByName[n]=c,e};i.plugin.errors=[];i.plugin.debug=i.version==="@VERSION";i.removePlugin=function(n,t){var h,e;if(!t){if(t=n,n=i.p,i.protect.natives.indexOf(t.toLowerCase())>=0){i.error("'"+t+"' is a protected function name");return}for(h=i.registry.length,e=0;e<h;e++)if(i.registry[e].name===t){i.registry.splice(e,1);delete i.registryByName[t];delete i.manifest[t];delete n[t];return}}for(var u=n.data.trackEvents.byStart,s=n.data.trackEvents.byEnd,o=n.data.trackEvents.animating,r=0,f=u.length;r<f;r++)u[r]&&u[r]._natives&&u[r]._natives.type===t&&(u[r]._natives._teardown&&u[r]._natives._teardown.call(n,u[r]),u.splice(r,1),r--,f--,n.data.trackEvents.startIndex<=r&&(n.data.trackEvents.startIndex--,n.data.trackEvents.endIndex--)),s[r]&&s[r]._natives&&s[r]._natives.type===t&&s.splice(r,1);for(r=0,f=o.length;r<f;r++)o[r]&&o[r]._natives&&o[r]._natives.type===t&&(o.splice(r,1),r--,f--)};i.compositions={};i.compose=function(n,t,r){i.manifest[n]=r=r||t.manifest||{};i.compositions[n]=t};i.plugin.effect=i.effect=i.compose;b=/^(?:\.|#|\[)/;i.dom={debug:!1,find:function(n,r){var u=null;if(r=r||t,n){if(!b.test(n)&&(u=t.getElementById(n),u!==null))return u;try{u=r.querySelector(n)}catch(f){if(i.dom.debug)throw new Error(f);}}return u}};k=/\?/;d={ajax:null,url:"",data:"",dataType:"",success:i.nop,type:"GET",async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8"};i.xhr=function(n){var t;if(n.dataType=n.dataType&&n.dataType.toLowerCase()||null,n.dataType&&(n.dataType==="jsonp"||n.dataType==="script")){i.xhr.getJSONP(n.url,n.success,n.dataType==="script");return}return t=i.extend({},d,n),t.ajax=new XMLHttpRequest,t.ajax?(t.type==="GET"&&t.data&&(t.url+=(k.test(t.url)?"&":"?")+t.data,t.data=null),t.ajax.open(t.type,t.url,t.async),t.type==="POST"&&t.ajax.setRequestHeader("Content-Type",t.contentType),t.ajax.send(t.data||null),i.xhr.httpData(t)):void 0};i.xhr.httpData=function(n){var t,r=null,u,i=null;return n.ajax.onreadystatechange=function(){if(n.ajax.readyState===4){try{r=JSON.parse(n.ajax.responseText)}catch(f){}if(t={xml:n.ajax.responseXML,text:n.ajax.responseText,json:r},!t.xml||!t.xml.documentElement){t.xml=null;try{u=new DOMParser;i=u.parseFromString(n.ajax.responseText,"text/xml");i.getElementsByTagName("parsererror").length||(t.xml=i)}catch(f){}}n.dataType&&(t=t[n.dataType]);n.success.call(n.ajax,t)}},t};i.xhr.getJSONP=function(n,r,u){var o=t.head||t.getElementsByTagName("head")[0]||t.documentElement,e=t.createElement("script"),l=!1,s=[],a=/(=)\?(?=&|$)|\?\?/,h,f,c;u||(c=n.match(/(callback=[^&]*)/),c!==null&&c.length?(h=c[1].split("=")[1],h==="?"&&(h="jsonp"),f=i.guid(h),n=n.replace(/(callback=[^&]*)/,"callback="+f)):(f=i.guid("jsonp"),a.test(n)&&(n=n.replace(a,"$1"+f)),s=n.split(/\?(.+)?/),n=s[0]+"?",s[1]&&(n+=s[1]+"&"),n+="callback="+f),window[f]=function(n){r&&r(n);l=!0});e.addEventListener("load",function(){u&&r&&r();l&&delete window[f];o.removeChild(e)},!1);e.addEventListener("error",function(n){r&&r({error:n});u||delete window[f];o.removeChild(e)},!1);e.src=n;o.insertBefore(e,o.firstChild);return};i.getJSONP=i.xhr.getJSONP;i.getScript=i.xhr.getScript=function(n,t){return i.xhr.getJSONP(n,t,!0)};i.util={toSeconds:function(n,t){var r,f,e,u,o,s;return typeof n=="number"?n:(typeof n!="string"||/^([0-9]+:){0,2}[0-9]+([.;][0-9]+)?$/.test(n)||i.error("Invalid time format"),r=n.split(":"),f=r.length-1,e=r[f],e.indexOf(";")>-1&&(o=e.split(";"),s=0,t&&typeof t=="number"&&(s=parseFloat(o[1],10)/t),r[f]=parseInt(o[0],10)+s),u=r[0],{1:parseFloat(u,10),2:parseInt(u,10)*60+parseFloat(r[1],10),3:parseInt(u,10)*3600+parseInt(r[1],10)*60+parseFloat(r[2],10)}[r.length||1])}};i.p.cue=i.p.exec;i.protect={natives:tt(i.p).map(function(n){return n.toLowerCase()})};i.forEach({listen:"on",unlisten:"off",trigger:"emit",exec:"cue"},function(n,t){var r=i.p[t];i.p[t]=function(){return typeof console!="undefined"&&console.warn&&(console.warn("Deprecated method '"+t+"', "+(n==null?"do not use.":"use '"+n+"' instead.")),i.p[t]=r),i.p[n].apply(this,[].slice.call(arguments))}});n.Popcorn=i})(window,window.document);
//# sourceMappingURL=popcorn.min.js.map
