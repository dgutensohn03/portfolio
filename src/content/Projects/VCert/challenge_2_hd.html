<!doctype html>
<html lang="en">

<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=yes">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="Bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="styles/style.css">
    <link rel="stylesheet" href="styles/challenge.css">
    <style>
        #box2 {
            background: url('./images/challenge_2/images/Video_BG_1.png')no-repeat center center;
            -webkit-background-size: cover;
            -moz-background-size: cover;
            -o-background-size: cover;
            background-size: cover;
            max-width: 1920px;
            position: absolute;
            overflow: hidden !important;
        }



    </style>
    <title>Vcert Project</title>
</head>
<style>

</style>

<body>
    <div class="container-fluid">
        <div class="box " id="box1">
            <div class="row align-middle full-box-height" id="content">
                <div class="col topCenterText ">
                    <div class='center-text-box'>
                        <h1>The Productive Partners</h1>
                        <p>
                            <font class="emphasisBold">VALVOLINE™</font> and <font class="emphasisBold">CUMMINS®</font>
                            have forged a strong partnership, resulting in innovative products and designs for both companies.
                        </p>
                        <p>Our collaborative innovations don’t just benefit Valvoline and Cummins, but the entire industry.
                        </p>
                        <p>
                            For this challenge, you’ll watch a minute and a half video showcasing the benefits of the Valvoline™ and
                            Cummins® relationship. After the video, you will be asked a series of questions.
                        </p>
                        <p>
                            The first video will highlight the overall relationship between Valvoline™ and Cummins®. The second will focus
                            on the R&D relationship between our two great companies.
                        </p>
                        <p>
                            <div class="headerBlue">SELECT START.</div>
                        </p>
                    </div>
					</div>
					<div class="col-1"></div>
					<div class="col topCenterText m-margin-bottom">
						<div>
							<button class="next" id="start-btn" type="submit">START</button>
						</div>
					</div>
				</div>
			</div>
            <div id="box2" class="box">
                <div class='back-btn'>
					<img src="">BACK
				</div>
                <div id="video-container">
                    <video id="player1" controls onplay=""
                        onended="$(this).parent().fadeOut(); $('#video-popup-1-mask').css('display','flex').hide().fadeIn();">
                        <source src="images/challenge_2/videos/Video_1V2.mp4">
                    </video>
                </div>
                <div id="content" class="row align-middle">
                    <div class="col topCenterText">
                        <div class="padding-50">
                            <div id="play-btn" onclick="playVideo_1()"></div>
                            <h1 class='white-txt video-text m-scale-text'>View Video</h1>
                        </div>
                    </div><div class="col m-none" style="flex-grow: 1;display: flex;align-items: center;justify-content: center;">
                        <div class="divider"></div>
                    </div>
                    
                    <div class="col topCenterText m-padding">
                        <div class='center-text-box'>
                            <h4 class='white-txt m-scale-text' style="margin-bottom: 20px;">VIDEO 1</h4>
                            <h1 class='white-txt m-scale-text'>
                                Watch this video to see how the Valvoline™ / Cummins® partnership benefits customers.
                            </h1>
                        </div>
                    </div>
                        <div id='video-popup-1-mask' class="video-popup">
                                <div class="video-dialog">
                                    <div class="video-border">
                                    <div id="video-popup-header">
                                        <div class="flex-c-sb">
                                            <div class="red-dot"></div>CONTINUE?<div class="red-dot"></div>
                                        </div>
                                    </div>
                                        <div class="row video-body">
                                            <div class="col flex-middle">
                                            <div id="yes-btn" class="next" onclick="">Yes</div>
                                        </div>
                                        <div class="col flex-middle">
                                            <div id="replay-btn" onclick="playVideo_1()">Replay</div>
                                        </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                </div>
            </div>
            <!-- QUESTION 1 -->
            <div id="box3" class="box question-bg-box">
                <div class='back-btn'>
					<img src="">BACK
				</div>
				<div class="row align-middle full-box-height" id="content">
					<div class="col topCenterText m-LeftCol-question back-btn-padding">
						<div class='center-text-box question-1'>
							<h1 id="question-num"></h1>
							<div class='question-text'></div>
							<div class='answer-container'></div>
						</div>
					</div>
					<div class="col topCenterText m-RightCol-question">
						<div class="reveal-btn text-white">
							<h3>REVEAL ANSWER</h3>
						</div>
						<div class="reveal-btn-m text-white">
							<h3>REVEAL ANSWER</h3>
						</div>

						<div class="remediation">
							<div class="remediation-icon"></div>
							<div class="remediation-txt"></div>
							<div class="remediation-continue next">
								Continue
							</div>
							<div class="remediation-retry">
								Try Again
								<div class='warn-sel-ans'>
									Choose an answer and select "Try Again."
								</div>
							</div>
							<div class="attempt-container row">
								<div class="attempt-1">
									FIRST ATTEMPT
								</div>
								<div class="attempt-2">
									SECOND ATTEMPT
								</div>
								<div class="attempt-3">
									RETRY IN 7 DAYS
								</div>
							</div>
						</div>
					</div>
				</div>
            </div>
            <!-- QUESTION 2 -->
            <div id="box4" class="box question-bg-box">
                <div class='back-btn'>
					<img src="">BACK
				</div>
				<div class="row align-middle full-box-height" id="content">
					<div class="col topCenterText m-LeftCol-question back-btn-padding">
						<div class='center-text-box question-2'>
							<h1 id="question-num"></h1>
							<div class='question-text'></div>
							<div class='answer-container'></div>
						</div>
					</div>
					<div class="col topCenterText m-RightCol-question">
						<div class="reveal-btn text-white">
							<h3>REVEAL ANSWER</h3>
						</div>
						<div class="reveal-btn-m text-white">
							<h3>REVEAL ANSWER</h3>
						</div>

						<div class="remediation">
							<div class="remediation-icon"></div>
							<div class="remediation-txt"></div>
							<div class="remediation-continue next">
								Continue
							</div>
							<div class="remediation-retry">
								Try Again
								<div class='warn-sel-ans'>
									Choose an answer and select "Try Again."
								</div>
							</div>
							<div class="attempt-container row">
								<div class="attempt-1">
									FIRST ATTEMPT
								</div>
								<div class="attempt-2">
									SECOND ATTEMPT
								</div>
								<div class="attempt-3">
									RETRY IN 7 DAYS
								</div>
							</div>
						</div>
					</div>
				</div>
            </div>
            <!-- QUESTION 3 -->
            <div id="box5" class="box question-bg-box">
                <div class='back-btn'>
					<img src="">BACK
				</div>
				<div class="row align-middle full-box-height" id="content">
					<div class="col topCenterText m-LeftCol-question back-btn-padding">
						<div class='center-text-box question-3'>
							<h1 id="question-num"></h1>
							<div class='question-text'></div>
							<div class='answer-container'></div>
						</div>
					</div>
					<div class="col topCenterText m-RightCol-question">
						<div class="reveal-btn text-white">
							<h3>REVEAL ANSWER</h3>
						</div>
						<div class="reveal-btn-m text-white">
							<h3>REVEAL ANSWER</h3>
						</div>

						<div class="remediation">
							<div class="remediation-icon"></div>
							<div class="remediation-txt"></div>
							<div class="remediation-continue next">
								Continue
							</div>
							<div class="remediation-retry">
								Try Again
								<div class='warn-sel-ans'>
									Choose an answer and select "Try Again."
								</div>
							</div>
							<div class="attempt-container row">
								<div class="attempt-1">
									FIRST ATTEMPT
								</div>
								<div class="attempt-2">
									SECOND ATTEMPT
								</div>
								<div class="attempt-3">
									RETRY IN 7 DAYS
								</div>
							</div>
						</div>
					</div>
				</div>
            </div>
            <!-- QUESTION 4 -->
            <div id="box6" class="box question-bg-box">
                <div class='back-btn'>
					<img src="">BACK
				</div>
				<div class="row align-middle full-box-height" id="content">
					<div class="col topCenterText m-LeftCol-question back-btn-padding">
						<div class='center-text-box question-4'>
							<h1 id="question-num"></h1>
							<div class='question-text'></div>
							<div class='answer-container'></div>
						</div>
					</div>
					<div class="col topCenterText m-RightCol-question">
						<div class="reveal-btn text-white">
							<h3>REVEAL ANSWER</h3>
						</div>
						<div class="reveal-btn-m text-white">
							<h3>REVEAL ANSWER</h3>
						</div>

						<div class="remediation">
							<div class="remediation-icon"></div>
							<div class="remediation-txt"></div>
							<div class="remediation-continue next">
								Continue
							</div>
							<div class="remediation-retry">
								Try Again
								<div class='warn-sel-ans'>
									Choose an answer and select "Try Again."
								</div>
							</div>
							<div class="attempt-container row">
								<div class="attempt-1">
									FIRST ATTEMPT
								</div>
								<div class="attempt-2">
									SECOND ATTEMPT
								</div>
								<div class="attempt-3">
									RETRY IN 7 DAYS
								</div>
							</div>
						</div>
					</div>
				</div>
            </div>
            <div id="box7" class="box">
                <div class="mask-img" style="position:absolute; top:0; overflow: visible;"><img id="learn-screen-img"
                    src="images/challenge_1/Conclsn-Photo.jpg" style="justify-content: center;"></div>
            <div class="row align-middle learn-box" id="content" style="height: 55% !important;">
                <div class="col-md-12 col-xl-6" style="text-align: left">
                    <div>
                        <h1>What Did We Learn Today?</h1>
                        <div>
                            <p>Valvoline’s™ partnership and collaborative work on product formulation alongside the innovative work by Cummins® engineers on their engines resulted in a product designed to ensure the best possible performance not just for Cummins® engines, but all other engine manufacturers who use Valvoline’s™ innovative product solutions.</p>
                        </div>
                    </div>
                </div>
                <div class="col-md-12 col-xl-6 learned-continue" style="min-height: 150px;">
                    <button class="next continue-btn-center" id="continue-btn-7">CONTINUE</button>
                </div>
            </div>
            </div>
            <div id="box8" class="box">
				<div class="row align-middle full-box-height" id="content">
					<div class="col topCenterText">
						<div class='center-text-box'>
                            <h1>Challenge Complete!</h1>
                            <div id='result-incorrect'>
                                <p>It was a good try, but to successfully complete a challenge, you need a score of 80% or higher on the challenge questions.</p>
                                <p>You earned 0 points this time.</p>
                                <p>You do have the opportunity to retake this challenge and earn some points!</p>
                                <p>Better luck next time!</p>
                            </div>
                            <div id='result-closed'>
                                <p>Looks like you still have some work to do with this topic. You did not earn a
                                passing score and no additional points will be added to your total.</p>
                                <p>While you wait for the next challenge to hit your inbox, you might want to return to your class materials and review some of the information around this specific topic.</p>
                                <p>This challenge will remain open so you can put that review to the test by taking the challenge again. (No points can be earned any longer for this challenge.)</p>
                                <p>A new challenge will be coming soon. Better luck next time!</p>
                            </div>
                            <div id='result-three'>
                                <p>You’ve completed this challenge review. If you would like to review this topic in
                                    greater depth, you may want to return to your class materials and review some of the
                                    information presented there.</p>
                                <p>As a reminder, no points will be earned for completing a challenge review.</p>
                            </div>
                            <div id='result-correct'>
                                <p>Great work!</p>
                                <p>You just earned yourself <span id="score">10</span> points.</p>
                                <p>Remember, you can’t earn any additional points from this challenge, but you can use
                                    it as reference.</p>
                                <p>Look for your next challenge soon.</p>
                            </div>
                            <!-- <div>For more information on this topic, check out some additional resources <a
                                    id="additional-resource" href="" target="_blank">here</a>.</div> -->
                        </div>
                    </div>
                    <div class="col topCenterText col-sm">
                        <div>
                            <button id="gameover-btn" type="submit">CONTINUE</button>
						</div>
					</div>
				</div>
			</div>
        </div>

    <div id='progress-bar'>
        <div class='line'></div>
        <div class='pin intro'></div>
        <div class='pin vid'></div>
        <div class='pin quest'>
            <div class='q-points'></div>
        </div>
        <div class='pin quest'>
            <div class='q-points'></div>
        </div>
        <div class='pin quest'>
            <div class='q-points'></div>
        </div>
        <div class='pin quest'>
            <div class='q-points'></div>
        </div>
        <div class='pin quest'></div>
        <div class='pin conclusion'></div>
        <div class='score'>0</div>
    </div>

	<footer><div>CHALLENGE #2</div></footer>
    <!-- <script src="../../bin/footerChallenge.js"></script> -->
    <script src="scripts/polyfill.min.js"></script>
    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="scripts/jquery-3.4.1.js"></script>
    <script src="scripts/popper.js/dist/umd/popper.min.js"></script>
    <script src="scripts/bootstrap/dist/js/bootstrap.min.js"></script>

    <!-- The core Firebase JS SDK is always required and must be listed first -->
    <script defer src="https://www.gstatic.com/firebasejs/7.5.0/firebase-app.js"></script>
    <script defer src="https://www.gstatic.com/firebasejs/7.5.0/firebase-auth.js"></script>
    <script defer src="https://www.gstatic.com/firebasejs/7.5.0/firebase-database.js"></script>
    <script defer src="https://www.gstatic.com/firebasejs/7.5.0/firebase-storage.js"></script>
    <script defer src="https://www.gstatic.com/firebasejs/7.5.0/firebase-functions.js"></script>
    <!-- <script src="https://www.gstatic.com/firebasejs/7.5.0/firebase-firestore.js"></script> -->
    <!-- TODO: Add SDKs for Firebase products that you want to use
         https://firebase.google.com/docs/web/setup#available-libraries -->
    <!-- <script src="https://www.gstatic.com/firebasejs/7.5.0/firebase-analytics.js"></script> -->
    <!-- <script defer src="src/fb-core-js.js"></script> -->
    <script defer src="bin/fb-auth.js"></script>
    <script src="bin/rules_popup_c2_hd.js"></script>
    <script>

        $('#challenge-btn', window.parent.document).html('VALUE TO THE CUSTOMER');
        var thisChallengNumber = 2;
        $('#additional-resource').attr('href', 'https://valvoline.widencollective.com/portals/xqbxpd5n/MyPortal572020');
        parent.setBookmarking("HD", thisChallengNumber, .2);
        parent.retrieveAttempt(thisChallengNumber, "HD");
        //QUIZ
        var ifrm = window.frameElement; // reference to iframe element container
        var doc = ifrm.ownerDocument; // reference to container's document
        var thisClass = function () {
            if (ifrm.src.includes("hd")) {
                return "HD";
            } else if (ifrm.src.includes("ld")) {
                return "LD";
            } else if (ifrm.src.includes("vps")) {
                return "VPS";
            }
        }
        
        //console.log(thisClass())
        ////////console.log(parent.activities)
        // $(doc).find('header').css('border-bottom', 'none');
        ifrm.style.top = '-118px';
        ifrm.style.position = 'absolute';
        ifrm.style.height = '100%';
        ifrm.style.zIndex = '1005';

        var quiz = [{
            // Q1
            question: '<p>Valvoline™ and Cummins® work closely to deliver the best engine, lubrication, and _______ technology.</p>',
            type: 'MC',
            answers: [
                'synthetic',
                'filtration',
                'long-lasting',
                'commercial'
            ],
            choices: [],
            correct: 2,
            correct_rem: '<p>That’s it. <b>Valvoline™</b> and <b>Cummins®</b>  work together in three core areas - engines, lubrication, and filtration - to increase our customers’ success and profitability.</p>',
            incorrect_rem: '<p>There’s a better answer. Try again and consider the three areas that are the focus of the Valvoline™/Cummins® partnership.</p>',
            fail_rem: '<p>That’s not right. The correct answer tells us that Valvoline™ and Cummins®  work together in three core areas - engines, lubrication, and filtration - to increase our customers’ success and profitability.</p><p>You will not receive any points for this question.</p>'
        }, {
            // Q2
            question: '<p>Which of these best describes the Valvoline™ / Cummins® partnership?</p>',
            type: 'MC',
            answers: [
                'Oil-based only',
                'A marketing-focused relationship',
                'Collaborative and innovative',
                'Driven by sales'
            ],
            choices: [],
            correct: 3,
            correct_rem: '<p>And those are just some of the ways to describe the partnership. Leadership at Cummins® Cummins is often asked why they continue their relationship with Valvoline™ rather than partner with a big oil and gas company. The answer is always the same. Valvoline™ is an agile company that places high value on relationships with its partners. Valvoline’s™  heavy emphasis on research and innovation means it is equipped with the latest technology. And, Valvoline™ is always willing to go the extra mile to deliver hands-on, in-person support to our partners and customers alike.</p>',
            incorrect_rem: '<p>There’s a better answer.</p>',
            fail_rem: '<p>That’s not right. The correct answer tells us that leadership at Cummins® Cummins is often asked why they continue their relationship with Valvoline™ rather than partner with a big oil and gas company. The answer is always the same. Valvoline™ is an agile company that places high value on relationships with its partners. Valvoline’s™Valvoline’s heavy emphasis on research and innovation means it is equipped with the latest technology. And, Valvoline™ is always willing to go the extra mile to deliver hands-on, in-person support to our partners and customers alike.</p><p>You will not receive any points for this question.</p>'
        }, {
            // Q3
            question: '<p>Valvoline™ and Cummins® are working on solutions for:</p>',
            type: 'MC',
            answers: [
                'diesel engines only',
                'diesel, alternative fuels, and future technologies',
                'on-highway equipment only',
                'alternative fuels and off-highway engines'
            ],
            choices: [],
            correct: 2,
            correct_rem: '<p>That’s it. The two companies are looking at technologies, both new and emerging, and working to create the best products and experiences for their customers.</p>',
            incorrect_rem: '<p>There’s a better answer. The two companies are looking at technologies, both new and emerging, and working to create the best products and experiences for their customers.</p>',
            fail_rem: '<p>That’s not right. The two companies are looking at technologies, both new and emerging, and working to create the best products and experiences for their customers.</p><p>You will not receive any points for this question.</p>'
        }, {
            // Q4
            question: '<p>Cummins® and Valvoline™ each have superior engineering and technical support that work hand-in-hand to design the best engine, lubrication, and filtration technology. One of the innovative results of this collaboration was ________________.</p>',
            type: 'MC',
            answers: [
                'Premium Blue™ ',
                'Zerex™',
                'Modern Engine',
                'All-Fleet™'
            ],
            choices: [],
            correct: 1,
            correct_rem: '<p>That’s it. Premium Blue™ is the only HD engine oil endorsed by any engine manufacturer. The lubricant trusted by Cummins® from the moment the engine is “born” throughout its entire lifecycle is Not Shell. Not Mobile. Not Chevron. Only Valvoline™ Premium Blue™.</p>',
            incorrect_rem: '<p>There’s a better answer. You want the only product of its kind used by Cummins® as the first fill in the factory.</p>',
            fail_rem: '<p>That’s not right. The correct answer tells us that  Premium Blue™ is the only HD engine oil endorsed by any engine manufacturer. The lubricant trusted by Cummins® from the moment the engine is “born” throughout its entire lifecycle is Not Shell. Not Mobile. Not Chevron. Only Valvoline™ Premium Blue™.</p><p>You will not receive any points for this question.</p>'
        }

            // , {
            //     // Q5
            //     question: 'While the Cummins® and Valvoline™ relationship is strong, it is confined to diesel engines only.',
            //     type: 'MC',
            //     answers: [
            //         'True',
            //         'False'
            //     ],
            //     choices: [],
            //     correct: 2,
            //     correct_rem: 'That’s right. From diesel to alternative fuels and beyond, the two companies are working to make sure they can continue to build a strong relationship, even in a changing machine-based landscape.',
            //     incorrect_rem: 'That’s not the right answer. From diesel to alternative fuels and beyond, the two companies are working to make sure they can continue to build a strong relationship, even in a changing machine-based landscape.'
            // }, {
            //     // Q5
            //     question: 'In this case study, only Cummins® engines benefitted from Valvoline™ products.',
            //     type: 'MC',
            //     answers: [
            //         'True',
            //         'False'
            //     ],
            //     correct: 2,
            //     choices: [],
            //     correct_rem: 'Correct! The customer reported improvements to their full fleet, a third of which were not Cummins® engines. Did you know: ⅓ of the market is not using Cummins® engines in their fleet. Those fleet owners can still see the benefits of Valvoline™ HD engine oils such as the potential extended drainage intervals, performance efficiencies and a reduction in the overall total cost of ownership.',
            //     incorrect_rem: 'So close, but still wrong. Remember, the customer reported improvements to their full fleet, a third of which were not Cummins® engines. Did you know: ⅓ of the market is not using Cummins® engines in their fleet. Those engine owners can still see benefits to their engines such as the potential extended drainage intervals, performance efficiencies, and a reduction in the overall total cost of ownership.'
            // }, {
            //     // Q6
            //     question: 'In the Dayton Freight video, the customer commented on the “cleanliness” they now see in their engines since switching to Premium Blue™. This result could be in part because of:',
            //     type: 'MC',
            //     answers: [
            //         'Since the switch, technicians at the site are checking the engine and oil more frequently.',
            //         'Advanced soot control and the excellent deposit protection of Premium Blue™',
            //         'The combined effect of using multiple Valvoline products.',
            //         'Changing oil grades.'
            //     ],
            //     choices: [],
            //     correct: 2,
            //     correct_rem: 'You nailed it!<br /><br />Valvoline™ Premium Blue™ motor oil features:<ul><li>Enhanced protection against oil oxidation</li><li>Improved fuel economy potential over conventional 15W-40 oils</li><li>Excellent deposit protection</li><li>Exceptional TBN retention</li><li>Enhanced fuel economy potential (vs. conventional oils)</li><li>Advanced soot control</li></ul>Among other benefits',
            //     incorrect_rem: 'That’s not correct. To find the right answer, consider the explicit benefits of Valvoline™ Premium Blue™ motor oil brings to the engine.'
            // }

        ]

        var passed = true;
        var questionPointsPossible = 100;
        var points = [20, 20, 20, 20]
        var attemptsLeft = [2, 2, 2, 2];
        var passPercent = 80;
        var boxLocation = 0;
        var attemptCount = 0;

        var totalPoints = function () {
            var sum = 0;
            for (var i = 0; i < points.length; i++) {
                sum += points[i]
            }
            return sum;

        }();

        var q = function () {
            return quiz[qIndex];
        }

        var currentAnswer;

        function RenderQuestion() {

				for (var qIndex = 0; qIndex < quiz.length; qIndex++) {
					$('.question-' + (qIndex + 1) + ' #question-num').html('Question ' + (qIndex + 1));
					$('.question-' + (qIndex + 1) + ' .question-text').html(quiz[qIndex].question);
					for (var i = 0; i < quiz[qIndex].answers.length; i++) {
						quiz[qIndex].choices.push(i + 1)
						var div = document.createElement('div')
						$(div).append('<input id="button' + (i + 1) + '" type="radio" name="quiz" value="' + (i + 1) +
							'" /><div id="answer' + (i + 1) + '"class="answer pointer"><\/div>');
						$(div).append('<label for="button' + (i + 1) + '">' + quiz[qIndex].answers[i] + '<\/label>');
						$('.question-' + (qIndex + 1) + ' .answer-container').append(div);
					}
				}
				var radioCheck = function () {
					$('.remediation-retry').unbind('click', runCheck);
					$('.reveal-btn-m').unbind('click', runCheck);
					$('.reveal-btn-m').bind('click', runCheck);
					currentAnswer = $(this).attr('id').slice(-1);
					currentQuestion = $(this).parent().parent().parent().attr('class').slice(-1);
					console.log('currentQuestion:' + currentQuestion)
					console.log(quiz[currentQuestion - 1].choices)
					if (quiz[currentQuestion - 1].choices[currentAnswer - 1] != 0 && attemptsLeft[currentQuestion - 1] < 2) {
						$('.remediation-retry').bind('click', runCheck);
						$('.remediation-retry .warn-sel-ans').css('opacity', '0');
					} else {
						$('.remediation-retry').unbind('click', runCheck);
						$('.remediation-retry .warn-sel-ans').css('opacity', '0');
					}
					
					if (attemptsLeft[currentQuestion - 1] == 0) {
						$('.reveal-btn').unbind('click', runCheck);
					} else {
						$('.reveal-btn').unbind('click', runCheck);
						$('.reveal-btn').bind('click', runCheck);
					}

					if (quiz[currentQuestion - 1].choices[currentAnswer - 1] == 0) {
						$('.reveal-btn-m').bind('click', runCheck);
					}

					if (quiz[currentQuestion - 1].type == "MC") {
						$('.answer-on').removeClass('answer-on').addClass('pointer');
						$(this).addClass("answer-on").removeClass('pointer');
					} else if (quiz[currentQuestion - 1].type == "MR") {
						$('.answer-on').removeClass('answer-on').addClass('pointer');
						$(this).addClass("answer-on").removeClass('pointer');
					}
				}

				$('.answer').bind('click', radioCheck);
				$('.remediation-retry').on('click', function () {
					//console.log($(this))
					$('.remediation-retry').unbind('click', runCheck);
					if (quiz[currentQuestion - 1].choices[currentAnswer - 1] == 0) {
						if ($(window).width() < 999) {
							$('.attempt-1').hide();
							$('.attempt-2').hide();
							$(this).parent().addClass("m-hide")
							$(this).parent().parent().parent().parent().find('.attempt-container').addClass("m-hide");
						} else {
							$(this).parent().parent().parent().parent().find('.attempt-container').removeClass("m-hide")
							$(this).parent().removeClass("m-hide");
							$('.remediation-retry .warn-sel-ans').css('opacity', '1');
						}
					}
				})

				$('.remediation-continue').on('click', function () {
					$('.reveal-btn').unbind('click', runCheck);
					$('.reveal-btn-m').unbind('click', runCheck);

					if (currentQuestion >= quiz.length - 1) {
						var userPoints = 0;
						for (var i = 0; i < points.length; i++) {
							userPoints += points[i]
						}
						scorePercent = parseInt((userPoints / totalPoints) * 100);
						var attempt = parent.intAttempt;
						console.log('Check score: ' + scorePercent >= passPercent)
						if (scorePercent >= passPercent && attempt < 4) {
							$('#result-correct').show();
							$('#gameover-btn').show();
							$('#result-incorrect').hide();
							$('#result-closed').hide();
							$('#result-three').hide();
							$('#result-retry').hide();
							$('#retry-btn').hide();
							console.log('Passed in first 3 attempts')
						} else if (scorePercent < passPercent && attempt < 4) {
							passed = false;
							$('#result-incorrect').show();
							$('#gameover-btn').show();
							$('#result-retry').hide();
							$('#result-closed').hide();
							$('#result-three').hide();
							$('#result-correct').hide();
							$('#retry-btn').hide();
							console.log('Failed in one of the first 3 attempts')
						} else if (attempt == 5) {
							passed = false;
							$('#result-incorrect').hide();
							$('#gameover-btn').show();
							$('#result-retry').hide();
							$('#result-closed').show();
							$('#result-three').hide();
							$('#result-correct').hide();
							$('#retry-btn').hide();
							console.log('Challenge Closed. Reviewing. No Points awarded.')
						} else if (attempt == 4) {
							$('#result-incorrect').hide();
							$('#gameover-btn').show();
							$('#result-retry').hide();
							$('#result-closed').hide();
							$('#result-three').show();
							$('#result-correct').hide();
							$('#retry-btn').hide();
							console.log('Just reviewing. Good Job!')
						}
					}
				})

				//Returns array of selected answers from a MR question
				function getAnswers() {
					var returnAnswers = [];
					$(".answer").each(function () {
						if ($(this).hasClass('answer-on')) {
							returnAnswers.push(Number($(this).attr('id').slice(-1)));
						}
					});
					return returnAnswers;
				}

				function arraysEqual(_arr1, _arr2) {
					if (!Array.isArray(_arr1) || !Array.isArray(_arr2) || _arr1.length !== _arr2.length)
						return false;
					var arr1 = _arr1.concat().sort();
					var arr2 = _arr2.concat().sort();
					for (var i = 0; i < arr1.length; i++) {
						if (arr1[i] !== arr2[i])
							return false;
					}
					return true;
				}

				var runCheck = function () {
                    console.log("run check")
                    console.log(currentQuestion)
					if (currentQuestion != undefined) {
						$('.remediation-retry').unbind('click', runCheck);
							if (attemptsLeft[currentQuestion - 1] >= 0) {
								var correctAnswer = quiz[currentQuestion - 1].correct;
								var thisQuestionAttemptsLeft = attemptsLeft[currentQuestion - 1];
								if (quiz[currentQuestion - 1].type == "MC") {
									$('.reveal-btn').unbind('click', runCheck);
									quiz[currentQuestion - 1].choices[currentAnswer - 1] = 0;
									for (var i = 0; i < quiz[currentQuestion - 1].choices.length; i++) {
										if (quiz[currentQuestion - 1].correct == currentAnswer) {
											//correct answer
											$('.question-' + currentQuestion + ' #answer' + (i + 1)).unbind().removeClass(
												"pointer");
										} else if (quiz[currentQuestion - 1].choices[i] == 0) {
											//incorrect answer
											$('.question-' + currentQuestion + ' #answer' + (i + 1)).unbind().removeClass(
												"pointer answer");
										} else if (attemptsLeft[currentQuestion - 1] == 0) {
											//failed question
											$('.question-' + currentQuestion + ' #answer' + (i + 1)).unbind().removeClass(
												"pointer");
										} else {
											//rebind answers
											$('.question-' + currentQuestion + ' #answer' + (i + 1)).unbind();
											$('.question-' + currentQuestion + ' #answer' + (i + 1)).bind('click', radioCheck).addClass("pointer");
										}
									}

									if (quiz[currentQuestion - 1].correct == currentAnswer) {
										$('.reveal-btn:eq(' + (currentQuestion - 1) + ')').hide();
										$('.question-bg-box:eq(' + (currentQuestion - 1) + ')').addClass('qbg-attempt-3');
										$('.reveal-btn:eq(' + (currentQuestion - 1) + ')').hide();
										$('.remediation:eq(' + (currentQuestion - 1) + ')').removeClass('m-hide')
										$('.attempt-container:eq(' + (currentQuestion - 1) + ')').removeClass("m-hide")
										$('.remediation:eq(' + (currentQuestion - 1) + ')').addClass('remediation-attempt-correct');
										$('.remediation:eq(' + (currentQuestion - 1) + ')').show();
										$('.remediation-retry:eq(' + (currentQuestion - 1) + ')').hide();
										$('.remediation-continue:eq(' + (currentQuestion - 1) + ')').show();
										$('.remediation-txt:eq(' + (currentQuestion - 1) + ')').removeClass('white-txt').html(quiz[currentQuestion - 1].correct_rem);
										$('.remediation-icon:eq(' + (currentQuestion - 1) + ')').css("background-image",
											"url(images/challenge_2/images/Correct_Icon.png)");
										$('.question-' + currentQuestion + ' #answer' + currentAnswer).css("background-image",
											"url(images/challenge_2/images/Correct.png)").addClass('remediation-reveal')
											.removeClass("pointer answer");
										$('.question-' + currentQuestion + ' .answer').css('cursor', 'auto');

										$('.attempt-1').hide();
										$('.attempt-2').hide();
									} else {
										$('.answer-on').removeClass('answer-on');
										$('.reveal-btn:eq(' + (currentQuestion - 1) + ')').hide();
										$('.remediation-continue:eq(' + (currentQuestion - 1) + ')').hide();
										$('.remediation-txt:eq(' + (currentQuestion - 1) + ')').addClass('white-txt').html(quiz[currentQuestion - 1].incorrect_rem);
										$('.remediation-icon:eq(' + (currentQuestion - 1) + ')').css("background-image",
											"url(images/challenge_2/images/Incorrect_Icon.png)");
										$('.question-' + currentQuestion + ' #answer' + currentAnswer).css("background-image",
											"url(images/challenge_2/images/Incorrect.png)").addClass('remediation-reveal')
											.removeClass("pointer answer");
                                            if (attemptsLeft[currentQuestion - 1] >= 0 && points[currentQuestion - 1] > 0) {
											//console.log("INCORRECT RESPONSE: " + attemptsLeft[currentQuestion - 1])
											points[currentQuestion - 1] = points[currentQuestion - 1] - 5;
										}
										if (attemptsLeft[currentQuestion - 1] == 2) {
											$('.question-bg-box:eq(' + (currentQuestion - 1) + ')').addClass('qbg-attempt-1');
											$('.remediation:eq(' + (currentQuestion - 1) + ')').addClass('remediation-attempt-1');
											$('.remediation:eq(' + (currentQuestion - 1) + ')').show();
											$('.attempt-1').css('display', 'flex');
										} else if (attemptsLeft[currentQuestion - 1] == 1) {
											$('.question-bg-box:eq(' + (currentQuestion - 1) + ')').addClass('qbg-attempt-2');
											$('.remediation:eq(' + (currentQuestion - 1) + ')').removeClass('m-hide')
											$('.attempt-container:eq(' + (currentQuestion - 1) + ')').removeClass("m-hide")
											$('.remediation:eq(' + (currentQuestion - 1) + ')').addClass('remediation-attempt-2');
											$('.remediation:eq(' + (currentQuestion - 1) + ')').show();
											$('.attempt-1').hide();
											$('.attempt-2').css('display', 'flex');
										} else if (attemptsLeft[currentQuestion - 1] == 0) {
											$('.attempt-1').hide();
											$('.attempt-2').hide();
											$('.question-bg-box:eq(' + (currentQuestion - 1) + ')').addClass('qbg-attempt-3');
											$('.remediation:eq(' + (currentQuestion - 1) + ')').removeClass('m-hide')
											$('.attempt-container:eq(' + (currentQuestion - 1) + ')').removeClass("m-hide")
											$('.remediation:eq(' + (currentQuestion - 1) + ')').addClass('remediation-attempt-3');
											$('.remediation:eq(' + (currentQuestion - 1) + ')').show();
											$('.remediation-retry:eq(' + (currentQuestion - 1) + ')').hide();
											$('.remediation-continue:eq(' + (currentQuestion - 1) + ')').show();
											$('.remediation-txt:eq(' + (currentQuestion - 1) + ')').removeClass('white-txt').html(quiz[currentQuestion - 1].fail_rem);
											$('#progress-bar .quest').eq(currentQuestion - 1).addClass('quest-retry')
											$('.question-' + currentQuestion + ' .answer-container div').each(function (index, elem) {
												$('.question-' + currentQuestion + ' .answer').unbind().css('cursor', 'auto');
											});
										}
										attemptsLeft[currentQuestion - 1]--;
										updateProgressTracker();
									}
								}
							} // end of runCheck
					}
					$('.reveal-btn').bind('click', runCheck);
					$('.reveal-btn-m').bind('click', runCheck);
				}
            }
            
        (function () {
            $('#header-image', window.parent.document).fadeIn();
            $('.next').click(function (box) {

                var curLocation = boxLocation + 1;
                var nextLocation = boxLocation + 2;
                var currentBox = $('#box' + curLocation)
                var nextBox = $('#box' + nextLocation)
                $(currentBox).animate({
                    left: '-50%'
                }, 500, function () {
                    $(currentBox).css('left', '150%');
                    $(currentBox).appendTo('#container');
                });
                $(nextBox).animate({
                    left: '50%'
                }, 500);

                if (curLocation == 2) { $('#box2 #video-popup-1-mask').fadeOut(); }
                boxLocation++;
                nextAction(curLocation);
                updateProgressTracker()
            });

            $('.back-btn').click(function () {
                var preLocation = boxLocation;
                var curLocation = boxLocation + 1;
                var currentBox = $('#box' + curLocation)
                var prevBox = $('#box' + preLocation)
                console.log(curLocation)
                $(currentBox).animate({
                    left: '150%'
                }, 500, function () {
                    $(prevBox).css('left', ' ');
                    $(prevBox).prependTo('#container');
                });
                $(prevBox).css('left', '-150%').animate({
                    left: '50%'
                }, 500);

                if (curLocation == 2) {
                    $('video').each(function() {
    $(this).get(0).pause();

    $('#box2 #video-container').hide()

            // $('video')[0].pause();
});

                }
                boxLocation--;
                updateProgressTracker()
                backAction(boxLocation)
            });


            $('#gameover-btn').on('click', function (e) {
                parent.exitChallenge();
				if (passed && parent.intAttempt != 4) {
					challengeComplete(thisClass(), thisChallengNumber, score, true);
				} else if (parent.intAttempt != 4) {
					challengeComplete(thisClass(), thisChallengNumber, score, false);
				} else {
					parent.navigateIframe("portal.html");
				}
				$('#gameover-btn').unbind("click");
	        })

            var $video = $('video'),
                $window = $('#video-container');
                $footer = $('footer')

            $(window).resize(function () {
                var footerHeightStr = $('footer').css('height');
                var footerHeight = (footerHeightStr.substring(0, footerHeightStr.length - 2) - 1);
                var height = $window.height();
                $video.css('height', height);
                var videoWidth = $video.width(),
                    windowWidth = $window.width(),
                    marginLeftAdjust = (windowWidth - videoWidth) / 2;
                $video.css({
                    'height': height
                });
            }).resize();

        })();

        function nextBox(el) {
            $('#box2 #video-popup-1-mask').fadeOut();
            var curLocation = boxLocation + 1;
            var currentBox = $('#box' + curLocation)
            $(currentBox).animate({
                left: '-50%'
            }, 500, function () {
                $(currentBox).css('left', '150%');
                $(currentBox).appendTo('#container');
            });
            $(currentBox).next().animate({
                left: '50%'
            }, 500);
            boxLocation++;
            nextAction(curLocation);
            updateProgressTracker()
        }

        function playVideo_1() {
            $('#box2 #video-container').fadeIn();

            $('#box2 #video-popup-1-mask').fadeOut();
            $('video')[0].play();
        }

        function nextAction(groupIndex) {
            //console.log('next action switch: ' + groupIndex + " " + typeof (groupIndex))
            switch (groupIndex) {
                case "0":

                    break;
                case "1":

                    break;
                case "2":

                    break;
                case "3":

                    break;
                case 1:

                    break;
                case 2:

                    break;
                case 3:

                    break;
                case "calcComplete":

                    break;
                case 5:

                    break;
                case 9:

                    break;
                default:
                    break;
            }
        }

        function backAction(groupIndex) {
            //console.log('back action switch: ' + groupIndex + " " + typeof (groupIndex))
            switch (groupIndex) {
                case "0":

                    break;
                case "1":

                    break;
                case 2:

                    break;
                case 3:

                    break;
                case 5:

                    break;
                case "4":

                    break;
                case 9:

                    break;
                default:
                    break;
            }
        }


        function updateProgressTracker() {
            var userPoints = 0
            for (var i = 0; i < points.length; i++) {
                userPoints += points[i]
            }
            score = (userPoints);
            $('.score').html(score + " POINTS")
            $('#score').html(score)
            $('#progress-bar .quest .q-points').each(function (i, obj) {
                $('#progress-bar .quest .q-points').eq(i).html(points[i])
            })

            switch (boxLocation) {
                case 1:
                    $('#progress-bar .pin').eq(boxLocation - 1).addClass('intro-down');
                    $('#progress-bar .pin').eq(boxLocation).addClass('vid-down');
                    $('#progress-bar .pin').eq(boxLocation + 1).removeClass('quest-down');
                    break;
                case 2:

                    $('#progress-bar .pin').eq(boxLocation - 1).removeClass('vid-down');
                    $('#progress-bar .pin').eq(boxLocation).addClass('quest-down');
                    $('#progress-bar .pin').eq(boxLocation + 1).removeClass('quest-down');
                    break;
                case 3:
                    $('#progress-bar .pin').eq(boxLocation - 1).removeClass('quest-down');
                    $('#progress-bar .pin').eq(boxLocation).addClass('quest-down');

                    $('#progress-bar .pin').eq(boxLocation + 1).removeClass('quest-down');
                    break;
                case 4:
                    $('#progress-bar .pin').eq(boxLocation - 1).removeClass('quest-down');
                    $('#progress-bar .pin').eq(boxLocation).addClass('quest-down');
                    $('#progress-bar .pin').eq(boxLocation + 1).removeClass('quest-down');
                    break;
                case 5:
                    $('#progress-bar .pin').eq(boxLocation - 1).removeClass('quest-down');
                    $('#progress-bar .pin').eq(boxLocation).addClass('quest-down');
                    $('#progress-bar .pin').eq(boxLocation + 1).removeClass('quest-down');
                    break;
                case 6:
                    $('#progress-bar .pin').eq(boxLocation - 1).removeClass('quest-down');
                    $('#progress-bar .pin').eq(boxLocation).addClass('quest-down');
                    $('#progress-bar .pin').eq(boxLocation + 1).removeClass('conclusion-down');
                    break;
                case 7:
                    $('#progress-bar .pin').eq(boxLocation - 1).removeClass('quest-down');
                    $('#progress-bar .pin').eq(boxLocation).addClass('conclusion-down');
                    break;
                default:
                    $('#progress-bar .pin').eq(0).removeClass('intro-down');
                    $('#progress-bar .pin').eq(1).removeClass('scene-down');
                    break;
            }
        };
        updateProgressTracker();
        RenderQuestion();




    </script>
</body>

</html>