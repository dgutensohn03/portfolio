<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Export Firebase Data to Google Sheets</title>
</head>
<body>

<button id="exportButton" style="background-color: red; color: white;">Export to Excel</button>

<script>
document.getElementById('exportButton').addEventListener('click', function() {
    // Fetch data from Firebase
    fetch('https://us-central1-vcert-9568e.cloudfunctions.net/generateReports', {
        mode: 'no-cors'
    })
    .then(response => response.text())
    .then(data => {
        // Format data as CSV
        let csvContent = 'data:text/csv;charset=utf-8,';
        csvContent += data;

        // Create a link element to trigger the download
        const encodedUri = encodeURI(csvContent);
        const link = document.createElement('a');
        link.setAttribute('href', encodedUri);
        link.setAttribute('download', 'firebase_data.csv');
        document.body.appendChild(link);

        // Trigger the download
        link.click();
    })
    .catch(error => console.error('Error fetching data:', error));
});
</script>
</body>
</html>
